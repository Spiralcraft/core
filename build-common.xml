<project name="build-common">

  <property file="build.number"/>
  <property name="build.name" value="spiralcraft-${module}-${version}-b${build.number}"/>
  <property name="manifest.class.path" value=""/>
  
  <target name="build">
    <buildnumber/>
    <echo message= "build: ${build.name}"/>
    <javac 
      classpath="${classpath}"
      srcdir="source" 
      debug="true"
    />
  </target>

  
  <target name="jar" depends="build">
    <echo message= "jar: ${build.name}"/>
    <jar 
      destfile="../../lib/spiralcraft-${module}.jar" 
      basedir="source"
      includes="spiralcraft/**/*.class,spiralcraft/**/*.xml"
      >
     <Manifest>
        <attribute name="Class-Path" value="${manifest.class.path}"/>
     </Manifest>
       
    </jar>
  </target>

  <target name="doc" depends="build">
		<javadoc 
      classpath="source:${classpath}"
			sourcepath="source"
      packagenames="spiralcraft.**.**"
        
			header="spiralcraft-${module}-${version} API"
			destdir="docs/api"
			author="Spiralcraft, Inc."
			version="${version}-b${build.number}"
			use="true"
			windowtitle="spiralcraft-${module}-${version} API"
			doctitle="&lt;h1&gt;spiralcraft-${module}-${version} API&lt;/h1&gt;"
			maxmemory="90M"
			failonerror="true">
			<bottom>Copyright 1998,2005 Michael Toth, Spiralcraft, Inc.</bottom>
		</javadoc>


  </target>
  
  <target name="source" depends="build">
    <jar 
      destfile="../../distrib/spiralcraft-${module}-${version}-b${build.number}-source.jar" 
      basedir="../../.."
      includes="spiralcraft/modules/${module}/*.xml,spiralcraft/modules/${module}/**/*.java,spiralcraft/modules/${module}/**/*.xml"
      >
    </jar>

  </target>

  <target name="distrib" depends="source,doc">
    <copy
      file="../../lib/spiralcraft-${module}.jar"
      tofile="../../distrib/spiralcraft-${module}-${version}-b${build.number}.jar" 
      >
    </copy>

    <jar 
      destfile="../../distrib/spiralcraft-${module}-${version}-b${build.number}-docs.jar" 
      basedir="."
      includes="docs/**"
      >
    </jar>
    
  </target>

</project>