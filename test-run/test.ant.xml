<project name="spiralcraft-core-shell" basedir="." default="smoke-tests">

  <macrodef name="spiralcraft">
    <attribute name="assy"/>
    <sequential>
      <java
        jar="../../../build/lib/spiralcraft.jar"
        failonerror="true"
        fork="true"
        >
        <arg value="-codebase"/>
        <arg value=".."/>
        <arg value="exec"/>
        <arg value="--log"/>
        <arg value="out/spiralcraft"/>
       
        <arg value="@{assy}"/>
      </java>
    </sequential>
  </macrodef>
  
  <target name="smoke-tests"
    depends="clean,spiralcraft-task,spiralcraft-io-smoke"
    >
  </target>
	
  <target name="all-tests" 
    depends="clean,smoke-tests,spiralcraft-io-long"
    >

  </target>

  <target name="clean">
    <mkdir dir="out"/>
    <delete>
      <fileset dir="out" includes="**/*"/>
    </delete>    
  </target>
  	
  <target name="spiralcraft-task">
  </target>
  	
  <target name="spiralcraft-io-smoke">
    <mkdir dir="out/io"/>
  	
    <spiralcraft 
      assy="class:/spiralcraft/io/test/FileRecordIterator.test.assy"
    />
  </target>
  	
  <target name="spiralcraft-io-long">
  	
    <spiralcraft 
      assy="class:/spiralcraft/io/test/RotatingFileOutputAgent.test.assy"
    />

  </target>
	
	
</project>
