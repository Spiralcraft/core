<task:Session
  xmlns:task="class:/spiralcraft/task/"
  xmlns:query="class:/spiralcraft/data/query/"
  xmlns:dtask="class:/spiralcraft/data/task/"
  xmlns:test="class:/spiralcraft/test/"
  xmlns:example="class:/spiralcraft/data/test/example/"
  >
  
  <type x="[@example:BatchSession].type"/>
  
  <scenario>
    <task:Sequence>
      <scenarios>
        <dtask:Collector>
    
          <x>[example:BatchSession].results
          </x>
          
          <logTaskResults>false
          </logTaskResults>

          <scenario>
            <query:QueryScenario>
          
          
              <query>
                <query:Scan>
                  <type x="[@example:Customer].type"/>
                </query:Scan>
              </query>
      
              <scenario>
                <task:Sequence>
                  <scenarios>
                    <task:Batch>
                      <source>[example:Customer.list]
                      </source>
                      
                      <scenario>
                        <task:Commander>
                          <commandX>[dtask:Collector] commandAdd([example:Customer])
                          </commandX>
                        </task:Commander>
                      </scenario>
                    </task:Batch>
        
                    <task:Batch>
                      <source>[example:Customer.list]
                      </source>

                      <parallel>true
                      </parallel>
                      
                      <scenario>
                        <task:Commander>
                          <commandX>[dtask:Collector] commandAdd([example:Customer])
                          </commandX>
                        </task:Commander>
                      </scenario>
                    </task:Batch>
                  </scenarios>
                </task:Sequence>
              </scenario>
      
            </query:QueryScenario>
          </scenario>
        </dtask:Collector>
        
        <test:Stub>
          <messageX>""+[example:BatchSession].results.@size()+" results"
          </messageX>
        </test:Stub>
        
      </scenarios>
    </task:Sequence>
  </scenario>
</task:Session>
